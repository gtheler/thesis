# manufactured solution (input)
phi1_mms(x,y) := 1 + sin(2*x)^2 * cos(3*y)^2;
phi2_mms(x,y) := (1-0.5*tanh(-y))*log(1+x);
D1(x,y) := 1 + 0.1*(x - 0.5*y);
Sigma_a1(x,y) := 1e-3*(1 + log(1+x) - 0.5*y^3);
Sigma_s1_2(x,y) := 1e-3*(1 - x + sqrt(0.5*y));
D2(x,y) := 1;
Sigma_a2(x,y) := 1e-3;
Sigma_s2_1(x,y) := 0;

# source terms (output)
S1(x,y) = (-18*sin(2*x)^2*(0.1*(x-0.5*y)+1)*sin(3*y)^2)-0.3*sin(2*x)^2*cos(3*y)*sin(3*y)+0.001*((-0.5*y^3)+log(x+1)+1)*(sin(2*x)^2*cos(3*y)^2+1)+26*sin(2*x)^2*(0.1*(x-0.5*y)+1)*cos(3*y)^2-8*cos(2*x)^2*(0.1*(x-0.5*y)+1)*cos(3*y)^2-0.4*cos(2*x)*sin(2*x)*cos(3*y)^2
S2(x,y) = (-0.001*(0.7071067811865476*sqrt(y)-x+1)*(sin(2*x)^2*cos(3*y)^2+1))+1.0*log(x+1)*sech(y)^2*tanh(y)+0.001*log(x+1)*(0.5*tanh(y)+1)+(0.5*tanh(y)+1)/(x+1)^2
J1x(x,y) = 4*cos(2*x)*sin(2*x)*((-0.1*(x-0.5*y))-1)*cos(3*y)^2
J1y(x,y) = -6*sin(2*x)^2*((-0.1*(x-0.5*y))-1)*cos(3*y)*sin(3*y)
J2x(x,y) = -(0.5*tanh(y)+1)/(x+1)
J2y(x,y) = -0.5*log(x+1)*sech(y)^2
neutron_square_dirichlet_tri3_struct
--------------------------------------------------------
-1.732868	-1.940256	-2.857245	4	32	25	68.38	0.85
-1.956012	-2.294614	-3.245481	6	50	36	68.60	1.48
-2.426015	-3.135938	-4.117575	8	128	81	68.32	1.11
-2.831480	-3.912782	-4.903437	12	288	169	66.94	0.76
-2.911523	-4.064462	-5.060684	14	338	196	68.91	1.40
-3.119162	-4.476305	-5.470755	16	512	289	66.96	1.05
-3.179787	-4.592663	-5.590985	18	578	324	68.98	0.71
-3.342306	-4.914294	-5.914309	20	800	441	69.62	1.38
neutron_square_dirichlet_tri3_frontal
--------------------------------------------------------
-1.892095	-2.260561	-3.211076	4	44	31	68.62	1.02
-2.249905	-2.884425	-3.982818	6	90	58	66.55	0.65
-2.543798	-3.445272	-4.596397	8	162	98	68.75	1.29
-2.920321	-4.269278	-5.398642	12	344	197	68.91	0.94
-3.065613	-4.382344	-5.697235	14	460	259	67.16	1.60
-3.206729	-4.657206	-5.945905	16	610	338	68.79	1.26
-3.324492	-4.982199	-6.196274	18	772	423	67.32	0.95
-3.426121	-5.178612	-6.392383	20	946	514	67.67	1.64
neutron_square_dirichlet_tri6_struct
--------------------------------------------------------
-1.732868	-3.952303	-4.818940	4	32	81	68.40	1.33
-1.956012	-4.656057	-5.482226	6	50	121	68.60	1.00
-2.426015	-6.131731	-6.877081	8	128	289	69.04	0.68
-2.649159	-6.780749	-7.538618	10	200	441	69.48	1.37
-2.831480	-7.282296	-8.075421	12	288	625	70.11	1.06
neutron_square_dirichlet_tri6_frontal
--------------------------------------------------------
-1.892095	-4.352575	-5.345640	4	44	105	66.58	0.74
-2.249905	-5.524928	-6.565805	6	90	205	70.78	1.41
-2.543798	-6.265874	-7.406476	8	162	357	69.17	1.09
-2.752666	-7.103499	-8.173417	10	246	533	69.85	0.78
-2.920321	-7.628486	-8.636487	12	344	737	70.75	1.49
neutron_square_dirichlet_quad4_struct
--------------------------------------------------------
-1.386294	-1.944237	-3.035157	4	16	25	70.36	1.18
-1.609438	-2.270777	-3.463197	6	25	36	66.39	0.85
-2.079442	-3.064392	-4.385041	8	64	81	68.34	1.53
-2.484907	-3.827359	-5.190226	12	144	169	68.56	1.22
-2.564949	-3.984474	-5.349788	14	169	196	68.62	0.90
-2.772589	-4.385532	-5.764236	16	256	289	70.87	1.59
-2.833213	-4.504591	-5.885386	18	289	324	69.25	1.27
-2.995732	-4.823465	-6.210461	20	400	441	69.30	0.96
neutron_square_dirichlet_quad4_frontal
--------------------------------------------------------
-1.545521	-2.076513	-3.093070	4	22	31	70.29	0.64
-1.903331	-2.652000	-3.858661	6	45	58	68.59	1.28
-2.191013	-3.158084	-4.383915	8	80	97	66.69	0.92
-2.564949	-4.020093	-5.332298	12	169	194	66.71	1.56
-2.705823	-3.932000	-5.497343	14	224	253	69.16	1.21
-2.848547	-4.354632	-5.781342	16	298	331	67.06	0.87
-2.971400	-4.531425	-5.989233	18	381	418	69.72	1.54
-3.067782	-4.922273	-6.327719	20	462	503	69.58	1.22
neutron_square_dirichlet_quad8_struct
--------------------------------------------------------
-1.386294	-4.538017	-5.489157	4	16	65	70.37	0.86
-1.609438	-5.082563	-6.162180	6	25	96	68.55	1.49
-2.079442	-6.501240	-7.562497	8	64	225	67.10	1.12
-2.302585	-7.145793	-8.220143	10	100	341	69.55	0.77
neutron_square_dirichlet_quad8_frontal
--------------------------------------------------------
-1.545521	-3.956508	-5.414105	4	22	83	72.73	1.41
-1.903331	-5.472746	-6.800014	6	45	160	66.79	1.04
-2.191013	-6.113574	-7.535865	8	80	273	69.37	0.69
-2.393746	-6.996569	-8.394817	10	120	401	69.61	1.34
neutron_square_neumann_tri3_struct
--------------------------------------------------------
-1.732868	-2.031775	-2.935154	4	32	25	70.43	0.96
-1.956012	-2.315586	-3.307157	6	50	36	68.39	1.57
-2.426015	-3.084004	-4.155390	8	128	81	66.66	1.19
-2.831480	-3.797093	-4.929697	12	288	169	68.63	0.81
-2.911523	-3.927133	-5.085197	14	338	196	68.77	1.44
-3.119162	-4.271864	-5.491040	16	512	289	66.98	1.08
-3.179787	-4.374523	-5.610012	18	578	324	69.28	0.71
-3.342306	-4.653340	-5.929658	20	800	441	69.53	1.36
neutron_square_neumann_tri3_frontal
--------------------------------------------------------
-1.892095	-2.203509	-3.253725	4	44	31	68.39	0.99
-2.249905	-2.828248	-4.025013	6	90	58	68.60	1.60
-2.543798	-3.416205	-4.639051	8	162	98	68.49	1.22
-2.920321	-4.263166	-5.446632	12	344	197	68.68	0.84
-3.065613	-4.377402	-5.738895	14	460	259	67.23	1.47
-3.206729	-4.668685	-5.990413	16	610	338	69.35	1.11
-3.324492	-4.962710	-6.235890	18	772	423	67.66	0.76
-3.426121	-5.163234	-6.427199	20	946	514	69.70	1.42
neutron_square_neumann_tri6_struct
--------------------------------------------------------
-1.732868	-4.043607	-4.889698	4	32	81	72.37	1.05
-1.956012	-4.696545	-5.530469	6	50	121	68.78	0.66
-2.426015	-6.022116	-6.888901	8	128	289	69.29	1.27
-2.649159	-6.606617	-7.516574	10	200	441	67.60	0.89
-2.831480	-7.016104	-7.968202	12	288	625	70.10	1.52
neutron_square_neumann_tri6_frontal
--------------------------------------------------------
-1.892095	-4.355948	-5.375531	4	44	105	66.60	1.15
-2.249905	-5.552806	-6.577232	6	90	205	68.96	0.76
-2.543798	-6.214248	-7.382300	8	162	357	67.33	1.38
-2.752666	-6.909687	-8.028953	10	246	533	69.89	1.00
-2.920321	-7.186976	-8.296331	12	344	737	70.67	0.64
neutron_square_neumann_quad4_struct
--------------------------------------------------------
-1.386294	-1.981726	-3.092348	4	16	25	66.82	1.26
-1.609438	-2.338584	-3.518799	6	25	36	66.35	0.87
-2.079442	-3.128114	-4.436621	8	64	81	68.57	1.48
-2.484907	-3.893376	-5.236932	12	144	169	68.74	1.10
-2.564949	-4.046379	-5.395079	14	169	196	68.77	0.72
-2.772589	-4.439728	-5.804666	16	256	289	70.90	1.34
-2.833213	-4.556462	-5.923965	18	289	324	69.43	1.02
-2.995732	-4.870587	-6.242567	20	400	441	69.63	0.71
neutron_square_neumann_quad4_frontal
--------------------------------------------------------
-1.545521	-2.204433	-3.252189	4	22	31	68.43	1.39
-1.903331	-2.720871	-3.957592	6	45	58	66.36	1.05
-2.191013	-3.211893	-4.430285	8	80	97	68.58	0.73
-2.564949	-4.058505	-5.425904	12	169	194	68.73	1.41
-2.705823	-3.919380	-5.540433	14	224	253	66.89	1.10
-2.848547	-4.433091	-5.833903	16	298	331	67.09	0.79
-2.971400	-4.703876	-6.039432	18	381	418	69.46	1.47
-3.067782	-4.918506	-6.402384	20	462	503	69.45	1.18
neutron_square_neumann_quad8_struct
--------------------------------------------------------
-1.386294	-4.580085	-5.488826	4	16	65	66.60	0.80
-1.609438	-5.082705	-6.156059	6	25	96	66.79	1.42
-2.079442	-6.417214	-7.519575	8	64	225	68.92	1.04
-2.302585	-6.909677	-8.086373	10	100	341	67.30	0.68
neutron_square_neumann_quad8_frontal
--------------------------------------------------------
-1.545521	-4.303977	-5.509111	4	22	83	66.53	1.30
-1.903331	-5.471960	-6.794112	6	45	160	70.89	0.92
-2.191013	-6.055953	-7.497523	8	80	273	69.48	1.55
-2.393746	-6.834924	-8.197128	10	120	401	69.51	1.19
